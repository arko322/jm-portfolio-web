---
import ProjectButton from './ProjectButton.astro'; // Botón abrir proyecto

interface ProjectTag {
  icon: {
    src: string;
  };
  label: string;
}

interface ProjectCardProps {
  id: string; // ID del proyecto
  image: {
    src: string;
  };
  title: string; // Título
  category: string; // Categoría
  description?: string; // Descripción corta
  longDescription?: string; // Descripción larga
  tags?: ProjectTag[]; // Tags del proyecto
}

const {
  id,
  image,
  title,
  category,
  description,
  longDescription,
  tags = [],
} = Astro.props as ProjectCardProps; // Props tipadas
---

<!-- Project card -->
<article
  data-open-project={id}
  class="group relative overflow-hidden bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition transform hover:-translate-y-1 hover:shadow-lg"
>
  <div class="grid md:grid-cols-[360px_1fr]">
    <!-- Imagen del proyecto -->
    <div class="relative block min-h-60 h-full border-r border-white/10">
      <img
        src={image.src}
        alt={title}
        loading="lazy"
        class="absolute inset-0 w-full h-full object-cover"
      />
    </div>

    <!-- Contenido -->
    <div class="p-6 min-w-0">
      <!-- Layout vertical -->
      <div class="flex flex-col justify-between h-full min-w-0 gap-6">
        <!-- Categoría + botón -->
        <div class="flex items-start justify-between gap-4 min-w-0">
          <p
            class="
              text-xs tracking-widest text-gray-400 uppercase
              min-w-0 flex-1
              line-clamp-1 overflow-hidden
            "
          >
            {category}
          </p>

          <div class="shrink-0">
            <ProjectButton projectId={id} /> <!-- Botón abrir lightbox -->
          </div>
        </div>

        <!-- Título + descripción + tags -->
        <div class="min-w-0">
          <h3 class="text-2xl font-semibold tracking-[-0.02em] leading-tight text-white/95 min-w-0">
            {title}
          </h3>

          {description && (
            <p class="mt-3 text-sm text-gray-400 leading-relaxed max-w-2xl line-clamp-2 min-w-0">
              {description}
            </p>
          )}

          {tags.length > 0 && (
            <div class="mt-4 max-w-full min-w-0">
              <!-- Tags scroll horizontal -->
              <div
                class="
                  project-card-tags
                  flex gap-2
                  overflow-x-auto overflow-y-hidden
                  whitespace-nowrap
                  touch-pan-x
                  select-none
                  max-w-full
                  pr-2
                "
              >
                {tags.map((tag) => (
                  <span
                    class="
                      flex items-center gap-2 shrink-0
                      rounded-full bg-white/5 border border-white/10 text-gray-300
                      hover:bg-white/10 transition hover:scale-[1.03]
                      px-4 py-2 text-sm
                    "
                  >
                    <img
                      src={tag.icon.src}
                      class="opacity-80 w-4 h-4"
                      alt=""
                    />
                    {tag.label}
                  </span>
                ))}
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  </div>
</article>
